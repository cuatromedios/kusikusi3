(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["c77e58c2"],{"0ccb":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"q-pb-xl"},[t.ready?n("lang-tabs"):t._e(),t.ready?n("div",t._l(t.$store.state.ui.config.models[t.$store.state.content.entity.model].editor,function(e){return n("q-card",t._b({key:e.index,staticClass:"q-mb-sm",attrs:{flat:"",bordered:""}},"q-card",e.props,!1),[n("q-card-section",[n("h2",[t._v(t._s(t.$t(e.groupName)))]),t._l(e.fields,function(t){return n("field-wrapper",{key:t.index,attrs:{label:t.label,field:t.field,component:t.component,props:t.props}})})],2)],1)}),1):t._e(),n("div",{staticClass:"text-center"},[t.ready&&"new"!==t.$store.state.content.entity.id?n("q-btn",{staticClass:"q-mt-md",attrs:{flat:"",color:"negative",size:"xs"},on:{click:t.deleteEntity}},[t._v("\n      "+t._s(t.$t("general.delete"))+"\n    ")]):t._e(),"new"===t._.get(t.$store,"state.content.entity.id")&&"admin"===t._.get(t.$store,"state.session.user.profile")?n("q-btn",{staticClass:"q-mt-md",attrs:{flat:"",size:"xs",color:"grey-5"},on:{click:function(e){t.showCustomId=!0}}},[t._v("\n      ID\n    ")]):t._e(),t.showCustomId?n("q-input",{attrs:{outlined:"",dense:"",autofocus:"",mask:"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",label:"Custom ID"},model:{value:t.customId,callback:function(e){t.customId=e},expression:"customId"}}):t._e()],1)],1)},s=[],a=n("967e"),r=n.n(a),o=(n("96cf"),n("fa84")),l=n.n(o),c=n("78de"),u=n("c723"),d={components:{FieldWrapper:c["a"],LangTabs:u["a"]},name:"ContentEdit",data:function(){return{showLangMenu:!0,ready:!1,customId:"",showCustomId:!1}},props:["saveBus"],computed:{title:function(){return this.$t("content.title")}},meta:function(){return{title:this.title}},beforeDestroy:function(){this.removeSaveButton()},mounted:function(){var t=l()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.removeSaveButton(),void 0===this.$store.state.ui.config.models?this.$store.watch(function(t){return t.ui.config.models},function(t,n){t&&e.getEntity()}):this.getEntity();case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),watch:{},methods:{getEntity:function(){var t=l()(r.a.mark(function t(){var e;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.removeSaveButton(),e=this.$route.params.entity_id,"new"!==e){t.next=7;break}return t.next=5,this.$store.dispatch("content/newEntity",{model:this.$route.params.model,parent_id:this.$route.params.parent_id});case 5:t.next=10;break;case 7:if(e===this.$store.state.content.entity.id){t.next=10;break}return t.next=10,this.$store.dispatch("content/getEntity",e);case 10:this.ready=!0,this.addSaveButton();case 12:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),saveEntity:function(){var t=l()(r.a.mark(function t(){var e;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.$store.state.ui.config.langs[0]&&this.$store.state.content.entity.contents[this.$store.state.ui.config.langs[0]]&&this.$store.state.content.entity.contents[this.$store.state.ui.config.langs[0]].title&&this.$store.commit("content/setEntityValue",{field:"name",value:this.$store.state.content.entity.contents[this.$store.state.ui.config.langs[0]].title}),"new"!==this.$route.params.entity_id){t.next=10;break}return this.$store.dispatch("content/clearId"),""!==this.customId&&(this.$store.state.content.entity.id=this.customId),t.next=6,this.$api.post("/entity",this.$store.state.content.entity);case 6:e=t.sent,e.success&&this.$router.push({name:"contentDisplay",params:{entity_id:e.result.id}}),t.next=14;break;case 10:return t.next=12,this.$api.patch("/entity/".concat(this.$route.params.entity_id),this.$store.state.content.entity);case 12:e=t.sent,e.success&&this.$router.push({name:"contentDisplay",params:{entity_id:this.$route.params.entity_id}});case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),cancelEdit:function(){var t=l()(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:"new"===this.$route.params.entity_id?this.$router.push({name:"contentDisplay",params:{entity_id:this.$route.params.parent_id}}):this.$router.push({name:"contentDisplay",params:{entity_id:this.$route.params.entity_id}});case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),deleteEntity:function(){var t=l()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$q.dialog({title:this.$t("general.sure"),message:this.$t("content.editor.delete"),color:"negative",cancel:{flat:!0,label:this.$t("general.cancel"),color:"grey"},ok:{color:"negative",label:this.$t("general.delete"),icon:"delete"},persistent:!0}).onOk(l()(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.delete("/entity/".concat(e.$route.params.entity_id));case 2:e.$router.push({name:"contentDisplay",params:{entity_id:e.$store.state.content.entity.parent_id}});case 3:case"end":return t.stop()}},t)})));case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addSaveButton:function(){this.saveBus.$on("on-save",this.saveEntity),this.saveBus.$on("on-cancel",this.cancelEdit),this.$store.commit("ui/setSaveButton",!0)},removeSaveButton:function(){this.saveBus.$off(),this.$store.commit("ui/setSaveButton",!1)}}},p=d,f=n("2877"),m=Object(f["a"])(p,i,s,!1,null,null,null);e["default"]=m.exports},"3eab":function(t,e,n){},"78de":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.langs,function(e){return n("div",{key:e,staticClass:"relative-position"},[n("div",{directives:[{name:"show",rawName:"v-show",value:""===e||e===t.$store.state.ui.editorLang||1===t.langs.length,expression:"lang === '' || lang === $store.state.ui.editorLang || langs.length === 1"}]},[n(t.component,{tag:"div",attrs:{label:t.label,field:t.field,lang:e,props:t.props}}),e&&""!==e&&t.langs.length>1?n("q-badge",{staticClass:"langBadge",attrs:{color:"info",floating:""}},[n("q-icon",{attrs:{name:"language"}}),t._v("â€‚"),n("span",[t._v(t._s(e))])],1):t._e()],1)])}),0)},s=[],a=(n("28a5"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-input",t._b({staticClass:"q-mb-sm",attrs:{filled:!0,label:t.$t(t.label),debounce:250},model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}},"q-input",t.props,!1))],1)}),r=[],o={name:"FieldBase",props:{field:{type:String,default:null},lang:{type:String,default:null},settingsObject:{type:Object,default:function(){return{}}}},computed:{fieldReference:{get:function(){var t,e=this.field.split(".");return 1===e.length?t=this.$store.state.content.entity[e[0]]:"contents"===e[0]?(this.$store.state.content.entity[e[0]][this.lang]||this.$store.commit("content/addLanguage",this.lang),void 0===this.$store.getters["content/getField"]("".concat(e[0],".").concat(this.lang,".").concat(e[1]))&&this.$store.commit("content/setEntityValue",{field:this.field,lang:this.lang,value:""}),t=this.$store.state.content.entity[e[0]][this.lang][e[1]]):t=this.$store.state.content.entity[e[0]][e[1]],t},set:function(t){this.$store.commit("content/setEntityValue",{field:this.field,lang:this.lang,value:t})}},settings:function(){return this.settingsObject||{}}}},l={name:"TextField",mixins:[o],props:["label","props"]},c=l,u=n("2877"),d=Object(u["a"])(c,a,r,!1,null,null,null),p=d.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-input",t._b({staticClass:"q-mb-sm",attrs:{filled:!0,label:t.$t(t.label),debounce:1e3,readonly:t.auto},scopedSlots:t._u([{key:"after",fn:function(){return[n("div",{staticClass:"q-gutter-sm"},[n("q-checkbox",{attrs:{label:"Auto"},model:{value:t.auto,callback:function(e){t.auto=e},expression:"auto"}})],1)]},proxy:!0}]),model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}},"q-input",t.props,!1))],1)},m=[],h=(n("7c0e"),{name:"TextField",mixins:[o],props:["label","lang","props"],data:function(){return{auto:!1}},mounted:function(){var t=this;"new"===this.$route.params.entity_id&&(this.auto=!0),this.$store.watch(function(e,n){return n["content/getField"]("contents.".concat(t.lang,".title"))},function(e,n){if(t.auto){var i=t._.trimEnd(t.parentUrl,"/"),s=t._.slugify(e,t.lang);t.$store.commit("content/setEntityValue",{field:"contents.url",value:"".concat(i,"/").concat(s),lang:t.lang})}})},methods:{},computed:{parentUrl:function(){if(this._.get(this.$store,"state.content.ancestors")){var t=this.$store.state.content.ancestors[this.$store.state.content.ancestors.length-1];return this._.get(t,"contents.".concat(this.lang,".url"),"")}return""}}}),g=h,v=Object(u["a"])(g,f,m,!1,null,null,null),b=v.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"bg-grey-2 q-px-md q-py-sm"},[t._v("\n    "+t._s(t.$t(t.label))+"\n  ")]),n("q-editor",t._b({ref:"editor_ref",staticClass:"q-mb-sm no-border no-border-radius",attrs:{"toolbar-bg":"grey-3","content-class":"bg-grey-1",filled:!0,debounce:1e3,definitions:{p2:{cmd:"formatBlock",param:"P",icon:"format_size",tip:"Paragraph"}},toolbar:[[{label:t.$q.lang.editor.formatting,icon:t.$q.iconSet.editor.formatting,list:"no-icons",options:["p2","h1","h2","h3","h4","h5","h6","code"]},"removeFormat"],["bold","italic","strike","underline"],["quote","unordered","ordered","outdent","indent"],["link"]],"min-height":"5rem"},nativeOn:{paste:function(e){return function(e){return t.pasteCapture(e)}(e)}},model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}},"q-editor",t.props,!1))],1)},$=[],y={name:"HtmlField",mixins:[o],props:["label","props"],mounted:function(){document.execCommand("defaultParagraphSeparator",!1,"p")},methods:{
/**
     * Capture the <CTL-V> paste event, only allow plain-text, no images.
     *
     * see: https://stackoverflow.com/a/28213320
     *
     * @param {object} evt - array of files
     * @author Daniel Thompson-Yvetot
     * @license MIT
     */
pasteCapture:function(t){var e,n;t.preventDefault(),t.originalEvent&&t.originalEvent.clipboardData.getData?(e=t.originalEvent.clipboardData.getData("text/plain"),this.$refs.editor_ref.runCmd("insertText",e)):t.clipboardData&&t.clipboardData.getData?(e=t.clipboardData.getData("text/plain"),this.$refs.editor_ref.runCmd("insertText",e)):window.clipboardData&&window.clipboardData.getData&&(n||(n=!0,this.$refs.editor_ref.runCmd("ms-pasteTextOnly",e)),n=!1)}}},_=y,w=(n("7cf7"),Object(u["a"])(_,x,$,!1,null,null,null)),q=w.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-input",t._b({staticClass:"q-mb-sm",attrs:{filled:!0,label:t.$t(t.label),debounce:500},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}})],1)],1)]},proxy:!0}]),model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}},"q-input",t.props,!1))],1)},E=[],C={name:"DatetimeField",mixins:[o],props:["label","props"]},D=C,R=Object(u["a"])(D,k,E,!1,null,null,null),B=R.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-toggle",t._b({staticClass:"q-mb-sm",attrs:{filled:!0,label:t.$t(t.label),debounce:500},model:{value:t.fieldReference,callback:function(e){t.fieldReference=e},expression:"fieldReference"}},"q-toggle",t.props,!1))],1)},F=[],O={name:"BooleanField",mixins:[o],props:["label","props"]},L=O,I=Object(u["a"])(L,S,F,!1,null,null,null),j=I.exports,Y={components:{TextField:p,HtmlField:q,UrlField:b,DatetimeField:B,BooleanField:j},name:"FieldWrapper",props:{label:{type:String,default:""},field:{type:String,default:null},props:void 0,component:{type:String,default:null}},data:function(){return{multilanguage:null}},computed:{langs:function(){var t=this.field.split(".");return"contents"===t[0]&&t.length>1?this.$store.state.ui.config.langs:[""]}},methods:{}},T=Y,H=(n("ed02"),Object(u["a"])(T,i,s,!1,null,null,null));e["a"]=H.exports},"7c0e":function(t,e,n){"use strict";n("aa77")("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},"7cf7":function(t,e,n){"use strict";var i=n("3eab"),s=n.n(i);s.a},af68:function(t,e,n){},c723:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return this.$store.state.ui.config.langs.length>1?n("q-tabs",{staticClass:"q-mb-lg",model:{value:t.editorLang,callback:function(e){t.editorLang=e},expression:"editorLang"}},t._l(t.langs,function(e){return n("q-tab",{key:e,attrs:{name:e}},[t._v("\n    "+t._s(e)+"\n  ")])}),1):t._e()},s=[],a={data:function(){return{}},mounted:function(){-1===this.$store.state.ui.config.langs.indexOf(this.$store.state.ui.editorLang)&&(this.editorLang=this.$store.state.ui.config.langs[0])},computed:{langs:function(){return this.$store.state.ui.config.langs},editorLang:{get:function(){return this.$store.state.ui.editorLang},set:function(t){this.$store.commit("ui/setEditorLang",t)}}}},r=a,o=n("2877"),l=Object(o["a"])(r,i,s,!1,null,null,null);e["a"]=l.exports},ed02:function(t,e,n){"use strict";var i=n("af68"),s=n.n(i);s.a}}]);